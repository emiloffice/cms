function showLogin(){FB.login(function(e){if(e.authResponse);else{mixpanelTrack("first chance login canceled");try{embedGameSwf(window.dm2048SwfVersionA,null)}catch(i){mixpanelTrack("error embedding swf: "+i.message)}}},{scope:"user_friends,publish_actions"})}function displayFlashScreenshot(){$("#flashContent").css("top","-10000px"),$("#imageContent").css("top","42px")}function hideFlashScreenshot(){$("#flashContent").css("top","0"),$("#imageContent").css("top","-10000px")}function onFlashHide(e){try{"opened"==e.state?displayFlashScreenshot():hideFlashScreenshot()}catch(i){Airbrake.push(i)}}function getFbUserInfo(){try{$("#SimpleSwf")[0].returnFbUserInfo(window.dm2048FirstName,window.dm2048LastName,window.dm2048TestGroup,window.dm2048ThirdPartyId)}catch(e){Airbrake.push(e)}}function secondChanceLogin(){try{mixpanelTrack("clicked FB login button"),FB.login(function(e){e.authResponse?($("#SimpleSwf")[0].authWithFbid(e.authResponse.userID,e.authResponse.accessToken),mixpanelTrack("accepted second chance login")):mixpanelTrack("second chance login canceled")},{scope:"user_friends,publish_actions"})}catch(e){Airbrake.push(e)}}function doShareScoresApi(e){try{FB.api("/me/scores","post",{score:e},function(e){})}catch(i){Airbrake.push(i)}}function doShareAchievementsApi(e){try{FB.api("/me/achievements","post",{achievement:e},function(e){})}catch(i){Airbrake.push(i)}}function doShareOpenGraphScorePoint(e,i){try{var n="http://piano-prod.elasticbeanstalk.com/piano/ogpoint/"+e+"?mode="+i;FB.api("/me/piano_tiles:score","post",{point:n},function(e){})}catch(t){Airbrake.push(t)}}function doShareOpenGraphFailGame(e){var i="http://piano-prod.elasticbeanstalk.com/piano/oggame/"+e;FB.api("/me/piano_tiles:fail","post",{game:i},function(e){})}function checkPermissions(){FB.api("/me?fields=permissions,third_party_id,first_name,last_name,gender,test_group",function(e){var i=e.permissions.data[0],n=[];for(var t in permsNeeded)null==i[permsNeeded[t]]&&n.push(permsNeeded[t]);n.length>0&&promptForPerms(n),window.dm2048FirstName=e.first_name,window.dm2048LastName=e.last_name,window.dm2048Gender=e.gender,window.dm2048Fbid=e.id,window.dm2048TestGroup=e.test_group,window.dm2048ThirdPartyId=e.third_party_id})}function initAnalytics(e){var i="",n="";try{var t=swfobject.getFlashPlayerVersion();i=t.major+"."+t.minor+"."+t.release,n=navigator.userAgent}catch(r){}generateGaSession(),gaTrackUser(e,n,i)}function inviteFriends(){try{FB.ui({method:"apprequests",message:"Don't Step the White Tile, on your computer!"},function(e){if(null!=e&&null!=e.to){for(var i=e.to,n=0,t=0;t<i.length;t++)n++;mixpanelTrack("invited "+n+" friends")}else mixpanelTrack("closed requests dialog without inviting friends")})}catch(e){Airbrake.push(e)}}function shareScoreUsingFbui(e){function i(e){}try{var n={method:"feed",link:"apps.facebook.com/piano_tiles",picture:"http://raiderbear-6a1.kxcdn.com/piano/images/og_keys_1500.jpg",name:e,caption:"Play Piano Tiles on your Keyboard",actions:[{name:"Play Piano Tiles!",link:"https://apps.facebook.com/piano_tiles"}]};FB.ui(n,i)}catch(t){Airbrake.push(t)}}function displayPurchase(e){try{FB.ui({method:"pay",action:"purchaseitem",product:e},function(e){if("failed"==e.status);else if("completed"==e.status){var i=e.signed_request,n=e.payment_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("completed",i,n)}else if("initiated"==e.status){var i=e.signed_request,n=e.payment_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("initiated",i,n)}})}catch(i){Airbrake.push(i)}}function displaySubscribe(e){try{FB.ui({method:"pay",action:"create_subscription",product:e},function(e){if("active"==e.status){var i=e.signed_request,n=e.subscription_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("sub_active",i,n)}else{var t=e.error_code,r=e.error_message;$("#SimpleSwf")[0].returnPurchaseStatusToAs("sub_fail",i,t+": "+r)}})}catch(i){Airbrake.push(i)}}function gaTrackUser(e,i,n){try{var t="U",r={user_id:e,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,gender:t,os_major:i,os_minor:n};gaTrack("user",r)}catch(a){Airbrake.push(a)}}function gaTrackDesign(e,i){try{if(i="undefined"!=typeof i?i:0,void 0==window.dm2048Fbid)return;var n={user_id:window.dm2048Fbid,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,event_id:e,value:i};gaTrack("design",n)}catch(t){Airbrake.push(t)}}function gaTrackBusiness(e,i,n){try{if(i="undefined"!=typeof i?i:"none",n="undefined"!=typeof n?n:0,void 0==window.dm2048Fbid)return;var t={user_id:window.dm2048Fbid,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,event_id:e,currency:i,amount:n};gaTrack("business",t)}catch(r){Airbrake.push(r)}}function gaTrackError(e,i){try{if(i="undefined"!=typeof i?i:"info",void 0==window.dm2048Fbid)return;var n={user_id:window.dm2048Fbid,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,message:e,severity:i};gaTrack("error",n)}catch(t){Airbrake.push(t)}}function gaTrack(e,i){try{var n="b6ba250033ddd08d59bb19162ffd5ca5",t="aa653b4c71b038215a6105d132d4a51f43eb0395",r=JSON.stringify(i),a=CryptoJS.MD5(r+t),o=CryptoJS.enc.Hex.stringify(a),s="https://api-eu.gameanalytics.com/1/"+n+"/"+e;$.ajax({type:"POST",url:s,data:r,headers:{Authorization:o},beforeSend:function(e){e.setRequestHeader("Content-Type","text/plain")},success:function(e,i,n){window.console&&console.log("GA success: "+i)},error:function(e,i,n){window.console&&console.log("GA error: "+n+", url: "+s)}})}catch(d){Airbrake.push(d)}}function generateGaSession(){try{window.dm2048GaSession="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=16*Math.random()|0,n="x"==e?i:3&i|8;return n.toString(16)})}catch(e){Airbrake.push(e)}}function trialpayDirectEarn(){TRIALPAY.fb.show_overlay("585528638221077","fbdirect",{tp_vendor_id:"NN7HJ8GGH",callback_url:"http://rbtest.elasticbeanstalk.com/piano/tpcallback",currency_url:"http://rbtest.elasticbeanstalk.com/piano/product/coin",sid:window.dm2048ThirdPartyId,order_info:window.dm2048Fbid})}function googleTrackGameLoad(){try{ga("send","event","game","load")}catch(e){Airbrake.push(e)}}function registerEventListeners(e){window.addEventListener&&(window.addEventListener("mousewheel",wheelHandler,!0),window.addEventListener("DOMMouseScroll",wheelHandler,!0),window.addEventListener("scroll",wheelHandler,!0),window.dm2048IsMac=e),window.onmousewheel=wheelHandler,document.onmousewheel=wheelHandler}function wheelHandler(e){if(!window.dm2048BrowserScrollAllow){var i=deltaFilter(e);void 0==i&&(i=e.detail),e||(e=window.event),(window.chrome||window.dm2048IsMac)&&$("#SimpleSwf")[0].scrollHappened(i),e.preventDefault?e.preventDefault():e.returnValue=!1}}function allowBrowserScroll(e){window.dm2048BrowserScrollAllow=e}function deltaFilter(e){var i=0;return e.wheelDelta?(i=e.wheelDelta/10,window.opera&&(i=-i)):e.detail&&(i=-e.detail),i}var permsNeeded=["user_friends","publish_actions"],ffInitApplifier=function(e){window.applifierAsyncInit=function(){Applifier.init({applicationId:2804,thirdPartyId:e});new Applifier.Bar({barType:"bar",barContainer:"#applifier_bar"})};var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=("https:"==document.location.protocol?"https://secure":"http://cdn")+".applifier.com/applifier.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)},promptForPerms=function(e){FB.login(function(e){},{scope:e.join(",")})};window.dm2048BrowserScrollAllow=!0,window.dm2048IsMac=!1;