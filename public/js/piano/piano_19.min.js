function showLogin(){FB.login(function(a){if(a.authResponse){}else{mixpanelTrack("first chance login canceled");try{embedGameSwf(window.dm2048SwfVersionA,null)}catch(b){mixpanelTrack("error embedding swf: "+b.message)}}},{scope:"user_friends,publish_actions"})}function displayFlashScreenshot(){$("#flashContent").css("top","-10000px");$("#imageContent").css("top","42px")}function hideFlashScreenshot(){$("#flashContent").css("top","0");$("#imageContent").css("top","-10000px")}function onFlashHide(b){try{if(b.state=="opened"){displayFlashScreenshot()}else{hideFlashScreenshot()}}catch(a){Airbrake.push(a)}}function getFbUserInfo(){try{$("#SimpleSwf")[0].returnFbUserInfo(window.dm2048FirstName,window.dm2048LastName,window.dm2048TestGroup,window.dm2048ThirdPartyId)}catch(a){Airbrake.push(a)}}function secondChanceLogin(){try{mixpanelTrack("clicked FB login button");FB.login(function(b){if(b.authResponse){$("#SimpleSwf")[0].authWithFbid(b.authResponse.userID,b.authResponse.accessToken);mixpanelTrack("accepted second chance login")}else{mixpanelTrack("second chance login canceled")}},{scope:"user_friends,publish_actions"})}catch(a){Airbrake.push(a)}}function doShareScoresApi(a){try{}catch(b){Airbrake.push(b)}}function doShareAchievementsApi(a){try{FB.api("/me/achievements","post",{achievement:a},function(c){})}catch(b){Airbrake.push(b)}}function doShareOpenGraphScorePoint(c,b){try{var a="http://piano-prod.elasticbeanstalk.com/piano/ogpoint/"+c+"?mode="+b;FB.api("/me/piano_tiles:score","post",{point:a},function(e){})}catch(d){Airbrake.push(d)}}function doShareOpenGraphFailGame(b){var a="http://piano-prod.elasticbeanstalk.com/piano/oggame/"+b;FB.api("/me/piano_tiles:fail","post",{game:a},function(c){})}var permsNeeded=["user_friends","publish_actions"];function checkPermissions(){FB.api("/me?fields=permissions,third_party_id,first_name,last_name,gender,test_group",function(b){var c=b.permissions.data[0];var a=[];for(var d in permsNeeded){if(c[permsNeeded[d]]==null){a.push(permsNeeded[d])}}if(a.length>0){promptForPerms(a)}window.dm2048FirstName=b.first_name;window.dm2048LastName=b.last_name;window.dm2048Gender=b.gender;window.dm2048Fbid=b.id;window.dm2048TestGroup=b.test_group;window.dm2048ThirdPartyId=b.third_party_id})}var ffInitApplifier=function(d){window.applifierAsyncInit=function(){Applifier.init({applicationId:2804,thirdPartyId:d});var a=new Applifier.Bar({barType:"bar",barContainer:"#applifier_bar"})};var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=(("https:"==document.location.protocol)?"https://secure":"http://cdn")+".applifier.com/applifier.min.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)};var promptForPerms=function(a){FB.login(function(b){},{scope:a.join(",")})};function initAnalytics(c){var b="";var a="";try{var e=swfobject.getFlashPlayerVersion();b=e.major+"."+e.minor+"."+e.release;a=navigator.userAgent}catch(d){}generateGaSession();gaTrackUser(c,a,b)}function inviteFriends(){try{FB.ui({method:"apprequests",message:"Don't Step the White Tile, on your computer!"},function(c){if(c!=null&&c.to!=null){var b=c.to;var e=0;for(var d=0;d<b.length;d++){e++}mixpanelTrack("invited "+e+" friends")}else{mixpanelTrack("closed requests dialog without inviting friends")}})}catch(a){Airbrake.push(a)}}function shareScoreUsingFbui(c){try{var b={method:"feed",link:"apps.facebook.com/piano_tiles",picture:"http://raiderbear-6a1.kxcdn.com/piano/images/og_keys_1500.jpg",name:c,caption:"Play Piano Tiles on your Keyboard",actions:[{name:"Play Piano Tiles!",link:"https://apps.facebook.com/piano_tiles"}]};function d(e){}FB.ui(b,d)}catch(a){Airbrake.push(a)}}function displayPurchase(b){try{FB.ui({method:"pay",action:"purchaseitem",product:b},function(d){if(d.status=="failed"){}else{if(d.status=="completed"){var e=d.signed_request;var c=d.payment_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("completed",e,c)}else{if(d.status=="initiated"){var e=d.signed_request;var c=d.payment_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("initiated",e,c)}}}})}catch(a){Airbrake.push(a)}}function displaySubscribe(b){try{FB.ui({method:"pay",action:"create_subscription",product:b},function(c){if(c.status=="active"){var g=c.signed_request;var e=c.subscription_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("sub_active",g,e)}else{var d=c.error_code;var f=c.error_message;$("#SimpleSwf")[0].returnPurchaseStatusToAs("sub_fail",g,d+": "+f)}})}catch(a){Airbrake.push(a)}}function gaTrackUser(a,d,f){try{var e="U";var c={user_id:a,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,gender:e,os_major:d,os_minor:f};gaTrack("user",c)}catch(b){Airbrake.push(b)}}function gaTrackDesign(a,d){try{d=typeof d!=="undefined"?d:0;if(window.dm2048Fbid==undefined){return}var c={user_id:window.dm2048Fbid,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,event_id:a,value:d};gaTrack("design",c)}catch(b){Airbrake.push(b)}}function gaTrackBusiness(b,a,c){try{a=typeof a!=="undefined"?a:"none";c=typeof c!=="undefined"?c:0;if(window.dm2048Fbid==undefined){return}var e={user_id:window.dm2048Fbid,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,event_id:b,currency:a,amount:c};gaTrack("business",e)}catch(d){Airbrake.push(d)}}function gaTrackError(a,b){try{b=typeof b!=="undefined"?b:"info";if(window.dm2048Fbid==undefined){return}var d={user_id:window.dm2048Fbid,session_id:window.dm2048GaSession,build:window.dm2048SwfBuildVersion,message:a,severity:b};gaTrack("error",d)}catch(c){Airbrake.push(c)}}function gaTrack(c,i){try{var g="b6ba250033ddd08d59bb19162ffd5ca5";var a="aa653b4c71b038215a6105d132d4a51f43eb0395";var f=JSON.stringify(i);var e=CryptoJS.MD5(f+a);var h=CryptoJS.enc.Hex.stringify(e);var b="https://api-eu.gameanalytics.com/1/"+g+"/"+c;$.ajax({type:"POST",url:b,data:f,headers:{Authorization:h,},beforeSend:function(j){j.setRequestHeader("Content-Type","text/plain")},success:function(k,l,j){if(window.console){console.log("GA success: "+l)}},error:function(j,l,k){if(window.console){console.log("GA error: "+k+", url: "+b)}}})}catch(d){Airbrake.push(d)}}function generateGaSession(){try{window.dm2048GaSession="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=Math.random()*16|0,b=e=="x"?d:(d&3|8);return b.toString(16)})}catch(a){Airbrake.push(a)}}function trialpayDirectEarn(){TRIALPAY.fb.show_overlay("585528638221077","fbdirect",{tp_vendor_id:"NN7HJ8GGH",callback_url:"http://rbtest.elasticbeanstalk.com/piano/tpcallback",currency_url:"http://rbtest.elasticbeanstalk.com/piano/product/coin",sid:window.dm2048ThirdPartyId,order_info:window.dm2048Fbid})}function googleTrackGameLoad(){try{ga("send","event","game","load")}catch(a){Airbrake.push(a)}}window.dm2048BrowserScrollAllow=true;window.dm2048IsMac=false;function registerEventListeners(a){if(window.addEventListener){window.addEventListener("mousewheel",wheelHandler,true);window.addEventListener("DOMMouseScroll",wheelHandler,true);window.addEventListener("scroll",wheelHandler,true);window.dm2048IsMac=a}window.onmousewheel=wheelHandler;document.onmousewheel=wheelHandler}function wheelHandler(a){if(!window.dm2048BrowserScrollAllow){var b=deltaFilter(a);if(b==undefined){b=a.detail}if(!a){a=window.event}if(window.chrome||window.dm2048IsMac){$("#SimpleSwf")[0].scrollHappened(b)}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}}function allowBrowserScroll(a){window.dm2048BrowserScrollAllow=a}function deltaFilter(a){var b=0;if(a.wheelDelta){b=a.wheelDelta/10;if(window.opera){b=-b}}else{if(a.detail){b=-a.detail}}return b};