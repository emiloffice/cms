function showLogin(){FB.login(function(a){if(a.authResponse){}else{mixpanelTrack("first chance login canceled");try{embedGameSwf(null)}catch(b){mixpanelTrack("error embedding swf: "+b.message)}}},{scope:"publish_actions"})}function displayFlashScreenshot(){$("#flashContent").css("top","-10000px");$("#imageContent").css("top","0")}function hideFlashScreenshot(){$("#flashContent").css("top","0");$("#imageContent").css("top","-10000px")}function onFlashHide(a){if(a.state=="opened"){displayFlashScreenshot()}else{hideFlashScreenshot()}}function getFbUserInfo(){$("#SimpleSwf")[0].returnFbUserInfo(window.flappyFirstName,window.flappyLastName,"Unknown",window.flappyTestGroup)}function secondChanceLogin(){mixpanelTrack("clicked FB login button");FB.login(function(a){if(a.authResponse){$("#SimpleSwf")[0].authWithFbid(a.authResponse.userID,a.authResponse.accessToken);mixpanelTrack("accepted second chance login")}else{mixpanelTrack("second chance login canceled")}},{scope:"publish_actions"})}function doShareScoresApi(a){FB.api("/me/scores","post",{score:a},function(b){})}function doShareAchievementsApi(a){FB.api("/me/achievements","post",{achievement:a},function(b){})}function doShareOpengraphScore(b,a){$.ajax({url:"//www.raiderbear.com/demo/ogpost/score/"+a+"?fbid="+b}).done(function(c,e,d){if(e!="success"){if(window.flappyOgError==undefined){mixpanelTrack("post action failure: "+e);window.flappyOgError=true}}}).fail(function(c,e,d){if(window.flappyOgError==undefined){mixpanelTrack("post action failure: "+d);window.flappyOgError=true}})}var permsNeeded=["publish_actions"];function checkPermissions(){FB.api("/me?fields=permissions,third_party_id,first_name,last_name,gender,test_group",function(b){var c=b.permissions.data[0];var a=[];for(var d in permsNeeded){if(c[permsNeeded[d]]==null){a.push(permsNeeded[d])}}if(a.length>0){promptForPerms(a)}window.flappyFirstName=b.first_name;window.flappyLastName=b.last_name;window.flappyGender=b.gender;window.flappyFlightFbid=b.id;window.flappyTestGroup=b.test_group;gaTrackDesign("document ready")})}var ffInitApplifier=function(d){window.applifierAsyncInit=function(){Applifier.init({applicationId:2804,thirdPartyId:d});var a=new Applifier.Bar({barType:"bar",barContainer:"#applifier_bar"})};var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=(("https:"==document.location.protocol)?"https://secure":"http://cdn")+".applifier.com/applifier.min.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)};var promptForPerms=function(a){FB.login(function(b){console.log(b)},{scope:a.join(",")})};function initAnalytics(c){var b="";var a="";try{var e=swfobject.getFlashPlayerVersion();b=e.major+"."+e.minor+"."+e.release;a=navigator.userAgent}catch(d){}generateGaSession();gaTrackUser(c,a,b)}function initKissmetrics(c,b,a){if(typeof _kmq!=="undefined"){_kmq.push(["identify",c]);_kmq.push(["record","kissmetrics initialized",{browser:b,"flash ver":a}])}}function initMixpanel(c,b,a){if(typeof mixpanel!=="undefined"){mixpanel.identify(c);mixpanel.track("mixpanel initialized new",{browser:b,"flash ver":a})}}function inviteFriends(){FB.ui({method:"apprequests",message:"It's time to Flap.",title:"Play Flappy Flight!"},function(b){if(b!=null&&b.to!=null){var a=b.to;var d=0;for(var c=0;c<a.length;c++){d++}mixpanelTrack("invited "+d+" friends")}else{mixpanelTrack("closed requests dialog without inviting friends")}})}function setPlayGameSuccess(a){gaTrackDesign("played game successfully",a)}function shareScoreUsingFbui(b){var a={method:"feed",link:"apps.facebook.com/flappyflight",picture:"https://d3et7r3ga59g4e.cloudfront.net/snaps/flappy_square_1500.jpg",name:b,caption:"Flappy Flight",actions:[{name:"Get Flapping!",link:"https://apps.facebook.com/flappyflight"}]};function c(d){console.log(d)}FB.ui(a,c)}function displayPurchase(a){console.log("opening purchase dialog");FB.ui({method:"pay",action:"purchaseitem",product:a},function(c){if(c.status=="failed"){console.log("purchase failed")}else{if(c.status=="completed"){var d=c.signed_request;var b=c.payment_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("completed",d,b)}else{if(c.status=="initiated"){var d=c.signed_request;var b=c.payment_id;$("#SimpleSwf")[0].returnPurchaseStatusToAs("initiated",d,b)}}}})}function selectFriendsForLife(){FB.ui({method:"apprequests",message:"I'm out of energy, can you send me one?",title:"These friends can help get you extra energy!",data:"lifeplease",filters:["app_users"]},function(b){if(b!=null&&b.to!=null){var a=b.to;var d=0;for(var c=0;c<a.length;c++){d++}mixpanelTrack("asked "+d+" friends")}else{mixpanelTrack("closed requests dialog without asking friends")}})}function helpFriends(a){FB.ui({method:"apprequests",message:"Here's some energy for you. Enjoy!",title:"Help friends by sending them energy!",data:"lifeforyou",to:a},function(c){if(c!=null&&c.to!=null){var b=c.to;var e=0;for(var d=0;d<b.length;d++){e++}mixpanelTrack("helped "+e+" friends")}else{mixpanelTrack("closed requests dialog without helping friends")}})}function acceptEnergy(a){FB.ui({method:"apprequests",message:"Here's some energy for you. Enjoy!",title:"Help friends by sending them energy!",data:"lifeforyou",to:a},function(c){if(c!=null&&c.to!=null){var b=c.to;var e=0;for(var d=0;d<b.length;d++){e++}$("#SimpleSwf")[0].returnEnergyAcceptToAs(e);mixpanelTrack("accepted help from "+e+" friends")}else{mixpanelTrack("closed requests dialog without accepting help from friends")}})}function processRequests(){FB.api("/me/apprequests",function(b){if(b&&!b.error){console.log(b);var e=new Array();var a=new Array();var h=b.data;for(var d=0;d<h.length;d++){var f=h[d];var c=f.data;if(c=="lifeforyou"){a.push(f.from)}else{if(c=="lifeplease"){e.push(f.from)}}var g=f.id;FB.api("/"+g,"DELETE",function(i){if(i&&!i.error){console.log(i)}})}$("#SimpleSwf")[0].returnRequestDataToAs(a,e)}})}function gaTrackUser(a,d,f){try{var e="U";var c={user_id:a,session_id:window.flappyFlightGaSession,build:"9.6",gender:e,os_major:d,os_minor:f};gaTrack("user",c)}catch(b){console.log("GA track user error: "+b.message)}}function gaTrackDesign(a,d){try{d=typeof d!=="undefined"?d:0;if(window.flappyFlightFbid==undefined){return}var c={user_id:window.flappyFlightFbid,session_id:window.flappyFlightGaSession,build:"9.6",event_id:a,value:d};gaTrack("design",c)}catch(b){console.log("GA track error error: "+b.message)}}function gaTrackBusiness(b,a,c){console.log("tracking business event: "+b+" currency: "+a+" amount: "+c);try{a=typeof a!=="undefined"?a:"none";c=typeof c!=="undefined"?c:0;if(window.flappyFlightFbid==undefined){return}var e={user_id:window.flappyFlightFbid,session_id:window.flappyFlightGaSession,build:"9.6",event_id:b,currency:a,amount:c};gaTrack("business",e)}catch(d){console.log("GA track error error: "+d.message)}}function gaTrackError(a,b){try{b=typeof b!=="undefined"?b:"info";if(window.flappyFlightFbid==undefined){return}var d={user_id:window.flappyFlightFbid,session_id:window.flappyFlightGaSession,build:"9.6",message:a,severity:b};gaTrack("error",d)}catch(c){console.log("GA track error error: "+c.message)}}function gaTrack(f,e){var d="c578796527de797c30fd6e84d428c6ca";var h="f7e37fa30f139547e5651cceb07c012a185dada9";var a=JSON.stringify(e);var g=CryptoJS.MD5(a+h);var c=CryptoJS.enc.Hex.stringify(g);var b="https://api-eu.gameanalytics.com/1/"+d+"/"+f;$.ajax({type:"POST",url:b,data:a,headers:{Authorization:c},beforeSend:function(i){i.setRequestHeader("Content-Type","text/plain")},success:function(j,k,i){console.log("GA success: "+k)},error:function(i,k,j){console.log("GA error: "+j+", url: "+b)}})}function generateGaSession(){try{window.flappyFlightGaSession="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=Math.random()*16|0,b=e=="x"?d:(d&3|8);return b.toString(16)})}catch(a){console.log("error generating uuid: "+a.message)}};